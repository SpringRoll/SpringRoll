/*! SpringRoll 0.3.11 */
!function(){"use strict";!function(){var a=function(a,b,c){this.task=b,this.data=c,this.type=a};a.TASK_ABOUT_TO_START="onItemAboutToLoad",a.TASK_STARTING="onItemLoading",a.TASK_DONE="onItemLoaded",namespace("springroll").TaskEvent=a}(),function(){var a=function(a,b){this.id=a,this.callback=b,this._isDestroyed=!1},b=a.prototype;b.done=function(a,b){this.callback&&this.callback(a,this,b)},b.start=function(){},b.cancel=function(){return!0},b.toString=function(){return"[Task ID ("+this.id+")]"},b.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this.callback=null,this.id=null)},namespace("springroll").Task=a}(),function(){var a=include("springroll.Task"),b=function(b,c,d){a.call(this,b,d),this.serviceCall=c,this.args=null,arguments.length>3&&(this.args=Array.prototype.slice.call(arguments,3))},c=a.prototype,d=extend(b,a);d.start=function(a){this.args?this.serviceCall.apply(null,[a].concat(this.args)):this.serviceCall.call(null,a)},d.toString=function(){return"[FunctionTask ID ("+this.id+")]"},d.destroy=function(){this._isDestroyed||(c.destroy.call(this),this.serviceCall=null,this.args=null)},namespace("springroll").FunctionTask=b}(),function(a){var b,c,d=include("springroll.Task"),e=function(e,f,g,h,i,j){b||(b=include("springroll.Loader"),c=include("springroll.LoaderQueueItem")),d.call(this,e,g),this.url=f,this.data=j,this.priority=i===a?c.PRIORITY_NORMAL:i,this.updateCallback=h},f=d.prototype,g=extend(e,d);g.start=function(a){b.instance.load(this.url,a,this.updateCallback,this.priority,this.data)},g.cancel=function(){return b.instance.cancel(this.url)},g.toString=function(){return"[LoadTask ID ("+this.id+"), URL ("+this.url+")]"},g.destroy=function(){this._isDestroyed||(f.destroy.call(this),this.updateCallback=null,this.url=null,this.data=null)},namespace("springroll").LoadTask=e}(),function(){var a,b,c=include("springroll.EventDispatcher"),d=function(d){a||(a=include("springroll.TaskEvent"),b=include("springroll.Debug",!1)),c.call(this),this.tasks=d||[],this._currentTasks=[],this.paused=!0,this._tasksInProgress=0,this._isDestroyed=!1},e=extend(d,c);d.ALL_TASKS_DONE="onAllTasksDone",d.process=function(a,b,c,e){e=e||!0,c=c||!0;var f=d.ALL_TASKS_DONE,g=new d(a);return g.on(f,function(){g.off(f),e&&g.destroy(),b&&b()}),c?g.startAll():g.startNext(),g},e.addTask=function(a){this.tasks.push(a)},e.addTasks=function(a){this.removeAll(),this.tasks=a},e.removeAll=function(){this._tasksInProgress=0,this.paused=!0;var a,b,c;if(this._currentTasks&&this._currentTasks.length>0)for(b=0,this._currentTasks.length;c>b;b++)a=this._currentTasks[b],a.cancel()&&a.destroy();if(this.tasks&&this.tasks.length>0)for(b=0,c=this.tasks.length;c>b;b++)a=this.tasks[b],a.destroy();this._currentTasks.length=0,this.tasks.length=0},e.cancelTask=function(a){var b;for(b=this._currentTasks.length-1;b>=0;--b)this._currentTasks[b].id==a&&this._currentTasks[b].cancel()&&(this._currentTasks[b].destroy(),this._currentTasks.splice(b,1),--this._tasksInProgress);for(b=this.tasks.length-1;b>=0;--b)this.tasks[b].id==a&&(this.tasks[b].destroy(),this.tasks.splice(b,1))},e.startNext=function(){if(!this._isDestroyed){for(var b;this.tasks.length>0&&!(b=this.tasks.shift()););return b?(this._currentTasks.push(b),this.paused=!1,this.has(a.TASK_ABOUT_TO_START)&&this.trigger(a.TASK_ABOUT_TO_START,new a(a.TASK_ABOUT_TO_START,b)),this.paused?null:(this.has(a.TASK_STARTING)&&this.trigger(a.TASK_STARTING,new a(a.TASK_STARTING,b)),this._tasksInProgress++,b.start(this.onTaskDone.bind(this,b)),b)):null}},e.onTaskDone=function(b,c){if(!this._isDestroyed){this._tasksInProgress--,this.has(a.TASK_DONE)&&this.trigger(a.TASK_DONE,new a(a.TASK_DONE,b,c)),b.done(c,this);var e=this._currentTasks.indexOf(b);e>-1&&this._currentTasks.splice(e,1),b.destroy(),0===this._tasksInProgress&&0===this.tasks.length?this.trigger(d.ALL_TASKS_DONE):this.paused||this.startNext()}},e.startAll=function(){for(var a=[];;){var b=this.startNext();if(!b)break;a.push(b)}return a},e.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this.off(),this.removeAll(),this._currentTasks=null,this.tasks=null)},namespace("springroll").TaskManager=d}(),function(){var a=include("springroll.Task"),b=include("springroll.LoadTask"),c=include("springroll.TaskEvent"),d=include("springroll.TaskManager"),e=function(c,d,e){a.call(this,c,e),this._manager=null,this._results=null;for(var f=[],g=0;g<d.length;g++)d[g]&&(d[g]instanceof a?f.push(d[g]):d[g].id&&d[g].src&&f.push(new b(d[g].id,d[g].src,d[g].callback,d[g].updateCallback,d[g].priority,d[g].data||d[g])));this.list=f},f=a.prototype,g=extend(e,a);g.start=function(a){this._results={},this._manager=new d(this.list.slice()),this._manager.on(c.TASK_DONE,this._onTaskDone.bind(this)),this._manager.on(d.ALL_TASKS_DONE,this._onAllTasksComplete.bind(this,a)),this._manager.startAll()},g._onTaskDone=function(a){this._isDestroyed||(this._results[a.task.id]=a.data)},g._onAllTasksComplete=function(a){this._isDestroyed||a(this._results)},g.cancel=function(){return this._manager.removeAll(),!0},g.toString=function(){return"[ListTask ID ("+this.id+"), tasks ("+this.list+")]"},g.destroy=function(){if(!this._isDestroyed){f.destroy.call(this),this._results=null;for(var a=0;a<this.list.length;a++)this.list[a].destroy();this._manager&&(this._manager.destroy(),this._manager=null),this.list=null}},namespace("springroll").ListTask=e}(),function(){var a,b,c,d=include("springroll.Task"),e=function(e,f,g,h){a||(c=include("PIXI.AssetLoader"),a=include("springroll.Loader"),b=include("springroll.Application")),d.call(this,e,g),this.updateCallback=h,this._assetLoader=null;for(var i=a.instance.cacheManager,j=b.instance.filters,k=0,l=f.length;l>k;++k)f[k]=j.filter(f[k]),f[k]=i.prepare(f[k],!0);this.urls=f},f=d.prototype,g=extend(e,d);g.start=function(a){var d=b.instance.options;this._assetLoader=new c(this.urls,d.crossOrigin,d.basePath),this._assetLoader.onComplete=a,this.updateCallback&&(this._assetLoader.onProgress=this.onProgress.bind(this)),this._assetLoader.load()},g.onProgress=function(){this.updateCallback()},g.cancel=function(){return this._assetLoader.onComplete=null,this._assetLoader.onProgress=null,!0},g.toString=function(){return"[PixiTask ID ("+this.id+"), URLs ("+this.urls.join(", ")+")]"},g.destroy=function(){this._isDestroyed||(f.destroy.call(this),this.updateCallback=null,this.urls=null,this._assetLoader&&(this._assetLoader.onComplete=null,this._assetLoader.onProgress=null),this._assetLoader=null)},namespace("springroll").PixiTask=e}(),function(){var a,b=include("springroll.ApplicationPlugin"),c=include("springroll.TaskManager"),d=include("springroll.LoadTask"),e=new b(80);e.setup=function(){a=include("springroll.Debug",!1),this.options.add("configPath",null,!0),this.config=null},e.preload=function(a){var b=[],e=this.options.configPath;e&&b.push(new d("config",e,f.bind(this))),this.trigger("loading",b),b.length?c.process(b,g.bind(this,a)):g.call(this,a)};var f=function(a,b,c){var d=this.config=a.content;this.trigger("configLoaded",d,c)},g=function(a){this.trigger("loaded"),a()};e.teardown=function(){this.config=null}}();}();