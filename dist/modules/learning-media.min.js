/*! SpringRoll 0.4.0 */
!function(){"use strict";!function(){var a=(include("springroll.Debug",!1),include("springroll.StringFilters"),function(){this.filters=null,this.learning=null,this.voPlayer=null,this.display=null}),b=a.prototype;b.init=function(a){this.filters=a.filters,this.learning=a.learning,this.voPlayer=a.voPlayer,this.display=a.display},b.playMovie=function(a,b,c,d){return this.learning.spec?this.triggerMoviePlay(a,b,c,d,"movie"):this.display.animator.play(a,b,options)},b.playInstruction=function(a,b,c,d){var e=this.learning,f=this.display.animator;return f.canAnimate(a)?e.spec?this.triggerMoviePlay(a,b,c,d,"instruction"):f.play(a,b,c,d):(d=c,c=b,b=a,e.spec?void this.triggerVOPlay(b,e.startInstruction,e.endInstruction,c,d):void this.voPlayer.play(b,c,d))},b.playIncorrectFeedback=function(a,b,c,d){var e=this.learning,f=this.display.animator;return f.canAnimate(a)?e.spec?this.triggerMoviePlay(a,b,c,d,"incorrect"):f.play(a,b,c,d):(d=c,c=b,b=a,e.spec?void this.triggerVOPlay(b,e.startIncorrectFeedback,e.endIncorrectFeedback,c,d):void this.voPlayer.play(b,c,d))},b.playCorrectFeedback=function(a,b,c,d){var e=this.learning,f=this.display.animator;return f.canAnimate(a)?e.spec?this.triggerMoviePlay(a,b,c,d,"correct"):f.play(a,b,c,d):(d=c,c=b,b=a,e.spec?void this.triggerVOPlay(b,e.startCorrectFeedback,e.endCorrectFeedback,c,d):void this.voPlayer.play(b,c,d))},b.triggerVOPlay=function(a,b,d,e,f){var g=this.display.animator;this.voPlayer.stop(),this._learningAnimatorInstance&&g.stop(this._learningAnimatorInstance);var h=this.voPlayer.captions,i=function(a){this.learning&&(d.call(this.learning),a&&a())};f===!0&&(f=e),this.voPlayer.play(a,i.bind(this,e),i.bind(this,f)),b.call(this.learning,h.getFullCaption(a),c(a),"audio",h.getLength(a))},b.triggerMoviePlay=function(a,b,c,d,e){var f=this.learning,g=this.display.animator;this.voPlayer.stop(),this._learningAnimatorInstance&&g.stop(this._learningAnimatorInstance),Array.isArray(b)||(b=[b]);for(var h,i,j,k,l,m,n,o=0,p="",q="",r=this.voPlayer.captions,s=0,t=b.length;t>s;++s){switch(h=b[s],n=null,m=null,typeof h){case"number":o+=h;break;case"string":h=this.filters.filter(h),o+=g.getDuration(a,h),n=h,m=r.getFullCaption(h),b[s]={anim:h,audio:h};break;case"object":h.anim=i=this.filters.filter(h.anim),h.audio&&("object"==typeof h.audio?h.audio.alias=j=this.filters.filter(h.audio.alias):h.audio=j=this.filters.filter(h.audio)),o+=g.getDuration(a,i),j?"string"!=typeof j&&(j=j.alias):j=i,m=r.getFullCaption(j),n=j}n&&(q.length>0&&(q+=","),q+=n),m&&(p.length>0&&(p+=" "),p+=m)}switch(o=0|o,e){case"instruction":f.startInstruction(p,q,"animation",o),k=f.endInstruction.bind(f);break;case"correct":f.startCorrectFeedback(p,q,"animation",o),k=f.endCorrectFeedback.bind(f);break;case"incorrect":f.startIncorrectFeedback(p,q,"animation",o),k=f.endIncorrectFeedback.bind(f);break;case"movie":f.startMovie(q,o,p),k=f.endMovie.bind(f),l=f.skipMovie.bind(f)}var u=function(a,b){this.learning&&(this._learningAnimatorInstance=null,a&&a(),b&&b())},v=u.bind(this,k,c),w=u.bind(this,l?l:k,d===!0?c:d);return this._learningAnimatorInstance=a,g.play(a,b,v,w)};var c=function(a){if(Array.isArray(a)){for(var b="",c=0,d=a.length;d>c;++c)"string"==typeof a[c]&&(b.length>0&&(b+=","),b+=a[c]);return b}return String(a)};b.stop=function(){this._learningAnimatorInstance?this.display.animator.stop(this._learningAnimatorInstance):this.voPlayer.stop()},b.isPlaying=function(){return this.voPlayer.playing||!!this._learningAnimatorInstance},b.destroy=function(){this.learning=null,this.voPlayer=null,this.display=null,this.filters=null},namespace("springroll").LearningMedia=a}(),function(a){var b=include("springroll.ApplicationPlugin"),c=include("springroll.LearningMedia"),d=new b;d.setup=function(){this.media=new c},d.preload=function(a){this.media.init(this),a()},d.teardown=function(){this.media&&(this.media.destroy(),this.media=null)}}();}();